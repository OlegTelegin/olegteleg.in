---
layout: archive
permalink: /year-archive/
title: "Useful services"
author_profile: true
---

<html>
  <head>
    <title>XLSX Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.6/xlsx.full.min.js">
    </script>
  </head>
  <body>
    <style>
          .wrapped-cell {
  word-wrap: break-word;
}
          </style>
    <script>
      fetch("https://api.github.com/repos/OlegTelegin/olegtelegin.github.io/contents/files/Far away from Macro.xlsx")
        .then(response => response.json())
  .then(json => {
    var data = json.content;
    var workbook = XLSX.read(data, {type: "base64"});
    var sheet = workbook.Sheets[workbook.SheetNames[0]];
    var table = document.createElement("table");
    table.style.position = "absolute";
    table.style.top = "150px";
    table.style.left = "200px";
    document.body.appendChild(table);
    for (var row = 0; row < 7; row++) {
      var tr = document.createElement("tr");
      table.appendChild(tr);
      for (var col = 0; col < 6; col++) {
        var cell = XLSX.utils.encode_cell({c: col, r: row});
        if (sheet[cell] && sheet[cell].v) {
          var value = sheet[cell].v;
          var td = document.createElement("td");
          td.innerHTML = value;
          td.classList.add("wrapped-cell");
          if (col == 0) {
            td.style.width = "20px";
          } else if (col == 1) {
            td.style.width = "30px";
          } else if (col == 2) {
            td.style.width = "20px";
          } else if (col == 3) {
            td.style.width = "100px";
          } else if (col == 4) {
            td.style.width = "140px";
          } else {
            td.style.width = "130px";
          }
          tr.appendChild(td);
        }
      }
    }
  });
    </script>
    Something else
  </body>
</html>
